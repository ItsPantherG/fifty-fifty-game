{"ast":null,"code":"/**\n * Copyright 2019 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _LifecycleWatcher_instances, _LifecycleWatcher_expectedLifecycle, _LifecycleWatcher_frameManager, _LifecycleWatcher_frame, _LifecycleWatcher_timeout, _LifecycleWatcher_navigationRequest, _LifecycleWatcher_eventListeners, _LifecycleWatcher_initialLoaderId, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, _LifecycleWatcher_sameDocumentNavigationPromise, _LifecycleWatcher_lifecycleCallback, _LifecycleWatcher_lifecyclePromise, _LifecycleWatcher_newDocumentNavigationCompleteCallback, _LifecycleWatcher_newDocumentNavigationPromise, _LifecycleWatcher_terminationCallback, _LifecycleWatcher_terminationPromise, _LifecycleWatcher_timeoutPromise, _LifecycleWatcher_maximumTimer, _LifecycleWatcher_hasSameDocumentNavigation, _LifecycleWatcher_swapped, _LifecycleWatcher_navigationResponseReceived, _LifecycleWatcher_onRequest, _LifecycleWatcher_onResponse, _LifecycleWatcher_onFrameDetached, _LifecycleWatcher_terminate, _LifecycleWatcher_createTimeoutPromise, _LifecycleWatcher_navigatedWithinDocument, _LifecycleWatcher_navigated, _LifecycleWatcher_frameSwapped, _LifecycleWatcher_checkLifecycleComplete;\nimport { assert } from '../util/assert.js';\nimport { addEventListener, removeEventListeners } from './util.js';\nimport { createDeferredPromise } from '../util/DeferredPromise.js';\nimport { TimeoutError } from './Errors.js';\nimport { FrameManagerEmittedEvents } from './FrameManager.js';\nimport { NetworkManagerEmittedEvents } from './NetworkManager.js';\nimport { CDPSessionEmittedEvents } from './Connection.js';\nconst puppeteerToProtocolLifecycle = new Map([['load', 'load'], ['domcontentloaded', 'DOMContentLoaded'], ['networkidle0', 'networkIdle'], ['networkidle2', 'networkAlmostIdle']]);\nconst noop = () => {};\n/**\n * @internal\n */\nexport class LifecycleWatcher {\n  constructor(frameManager, frame, waitUntil, timeout) {\n    _LifecycleWatcher_instances.add(this);\n    _LifecycleWatcher_expectedLifecycle.set(this, void 0);\n    _LifecycleWatcher_frameManager.set(this, void 0);\n    _LifecycleWatcher_frame.set(this, void 0);\n    _LifecycleWatcher_timeout.set(this, void 0);\n    _LifecycleWatcher_navigationRequest.set(this, null);\n    _LifecycleWatcher_eventListeners.set(this, void 0);\n    _LifecycleWatcher_initialLoaderId.set(this, void 0);\n    _LifecycleWatcher_sameDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_sameDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_lifecycleCallback.set(this, noop);\n    _LifecycleWatcher_lifecyclePromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_lifecycleCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_newDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_newDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_terminationCallback.set(this, noop);\n    _LifecycleWatcher_terminationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_terminationCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_timeoutPromise.set(this, void 0);\n    _LifecycleWatcher_maximumTimer.set(this, void 0);\n    _LifecycleWatcher_hasSameDocumentNavigation.set(this, void 0);\n    _LifecycleWatcher_swapped.set(this, void 0);\n    _LifecycleWatcher_navigationResponseReceived.set(this, void 0);\n    if (Array.isArray(waitUntil)) {\n      waitUntil = waitUntil.slice();\n    } else if (typeof waitUntil === 'string') {\n      waitUntil = [waitUntil];\n    }\n    __classPrivateFieldSet(this, _LifecycleWatcher_initialLoaderId, frame._loaderId, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_expectedLifecycle, waitUntil.map(value => {\n      const protocolEvent = puppeteerToProtocolLifecycle.get(value);\n      assert(protocolEvent, 'Unknown value for options.waitUntil: ' + value);\n      return protocolEvent;\n    }), \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frameManager, frameManager, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frame, frame, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeout, timeout, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_eventListeners, [addEventListener(frameManager.client, CDPSessionEmittedEvents.Disconnected, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_terminate).bind(this, new Error('Navigation failed because browser has disconnected!'))), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.LifecycleEvent, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameNavigatedWithinDocument, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigatedWithinDocument).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameNavigated, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigated).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameSwapped, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_frameSwapped).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManagerEmittedEvents.FrameDetached, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onFrameDetached).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManagerEmittedEvents.Request, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequest).bind(this)), addEventListener(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManagerEmittedEvents.Response, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onResponse).bind(this))], \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeoutPromise, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_createTimeoutPromise).call(this), \"f\");\n    __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n  }\n  async navigationResponse() {\n    var _a;\n    // Continue with a possibly null response.\n    await ((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.catch(() => {}));\n    return __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\") ? __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\").response() : null;\n  }\n  sameDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationPromise, \"f\");\n  }\n  newDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationPromise, \"f\");\n  }\n  lifecyclePromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_lifecyclePromise, \"f\");\n  }\n  timeoutOrTerminationPromise() {\n    return Promise.race([__classPrivateFieldGet(this, _LifecycleWatcher_timeoutPromise, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\")]);\n  }\n  dispose() {\n    removeEventListeners(__classPrivateFieldGet(this, _LifecycleWatcher_eventListeners, \"f\"));\n    __classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\") !== undefined && clearTimeout(__classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\"));\n  }\n}\n_LifecycleWatcher_expectedLifecycle = new WeakMap(), _LifecycleWatcher_frameManager = new WeakMap(), _LifecycleWatcher_frame = new WeakMap(), _LifecycleWatcher_timeout = new WeakMap(), _LifecycleWatcher_navigationRequest = new WeakMap(), _LifecycleWatcher_eventListeners = new WeakMap(), _LifecycleWatcher_initialLoaderId = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_lifecycleCallback = new WeakMap(), _LifecycleWatcher_lifecyclePromise = new WeakMap(), _LifecycleWatcher_newDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_newDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_terminationCallback = new WeakMap(), _LifecycleWatcher_terminationPromise = new WeakMap(), _LifecycleWatcher_timeoutPromise = new WeakMap(), _LifecycleWatcher_maximumTimer = new WeakMap(), _LifecycleWatcher_hasSameDocumentNavigation = new WeakMap(), _LifecycleWatcher_swapped = new WeakMap(), _LifecycleWatcher_navigationResponseReceived = new WeakMap(), _LifecycleWatcher_instances = new WeakSet(), _LifecycleWatcher_onRequest = function _LifecycleWatcher_onRequest(request) {\n  var _a, _b;\n  if (request.frame() !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") || !request.isNavigationRequest()) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationRequest, request, \"f\");\n  // Resolve previous navigation response in case there are multiple\n  // navigation requests reported by the backend. This generally should not\n  // happen by it looks like it's possible.\n  (_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.resolve();\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationResponseReceived, createDeferredPromise(), \"f\");\n  if (request.response() !== null) {\n    (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n  }\n}, _LifecycleWatcher_onResponse = function _LifecycleWatcher_onResponse(response) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== response.request()._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onFrameDetached = function _LifecycleWatcher_onFrameDetached(frame) {\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") === frame) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, new Error('Navigating frame was detached'));\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_terminate = function _LifecycleWatcher_terminate(error) {\n  __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, error);\n}, _LifecycleWatcher_createTimeoutPromise = async function _LifecycleWatcher_createTimeoutPromise() {\n  if (!__classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")) {\n    return new Promise(noop);\n  }\n  const errorMessage = 'Navigation timeout of ' + __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\") + ' ms exceeded';\n  await new Promise(fulfill => {\n    return __classPrivateFieldSet(this, _LifecycleWatcher_maximumTimer, setTimeout(fulfill, __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")), \"f\");\n  });\n  return new TimeoutError(errorMessage);\n}, _LifecycleWatcher_navigatedWithinDocument = function _LifecycleWatcher_navigatedWithinDocument(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_hasSameDocumentNavigation, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_navigated = function _LifecycleWatcher_navigated(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_frameSwapped = function _LifecycleWatcher_frameSwapped(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_swapped, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_checkLifecycleComplete = function _LifecycleWatcher_checkLifecycleComplete() {\n  // We expect navigation to commit.\n  if (!checkLifecycle(__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_expectedLifecycle, \"f\"))) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_lifecycleCallback, \"f\").call(this);\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_hasSameDocumentNavigation, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_swapped, \"f\") || __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")._loaderId !== __classPrivateFieldGet(this, _LifecycleWatcher_initialLoaderId, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  function checkLifecycle(frame, expectedLifecycle) {\n    for (const event of expectedLifecycle) {\n      if (!frame._lifecycleEvents.has(event)) {\n        return false;\n      }\n    }\n    for (const child of frame.childFrames()) {\n      if (child._hasStartedLoading && !checkLifecycle(child, expectedLifecycle)) {\n        return false;\n      }\n    }\n    return true;\n  }\n};","map":{"version":3,"mappings":"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","names":["assert","addEventListener","removeEventListeners","createDeferredPromise","TimeoutError","FrameManagerEmittedEvents","NetworkManagerEmittedEvents","CDPSessionEmittedEvents","puppeteerToProtocolLifecycle","Map","noop","LifecycleWatcher","constructor","frameManager","frame","waitUntil","timeout","_LifecycleWatcher_expectedLifecycle","_LifecycleWatcher_frameManager","_LifecycleWatcher_frame","_LifecycleWatcher_timeout","_LifecycleWatcher_navigationRequest","_LifecycleWatcher_eventListeners","_LifecycleWatcher_initialLoaderId","_LifecycleWatcher_sameDocumentNavigationCompleteCallback","_LifecycleWatcher_sameDocumentNavigationPromise","Promise","fulfill","__classPrivateFieldSet","_LifecycleWatcher_lifecycleCallback","_LifecycleWatcher_lifecyclePromise","_LifecycleWatcher_newDocumentNavigationCompleteCallback","_LifecycleWatcher_newDocumentNavigationPromise","_LifecycleWatcher_terminationCallback","_LifecycleWatcher_terminationPromise","_LifecycleWatcher_timeoutPromise","_LifecycleWatcher_maximumTimer","_LifecycleWatcher_hasSameDocumentNavigation","_LifecycleWatcher_swapped","_LifecycleWatcher_navigationResponseReceived","Array","isArray","slice","_loaderId","map","value","protocolEvent","get","client","Disconnected","__classPrivateFieldGet","bind","Error","LifecycleEvent","FrameNavigatedWithinDocument","FrameNavigated","FrameSwapped","FrameDetached","networkManager","Request","Response","navigationResponse","catch","response","sameDocumentNavigationPromise","newDocumentNavigationPromise","lifecyclePromise","timeoutOrTerminationPromise","race","dispose","undefined","clearTimeout","request","isNavigationRequest","resolve","_requestId","call","error","_LifecycleWatcher_createTimeoutPromise","errorMessage","setTimeout","checkLifecycle","expectedLifecycle","event","_lifecycleEvents","has","child","childFrames","_hasStartedLoading"],"sources":["../../../../src/common/LifecycleWatcher.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}