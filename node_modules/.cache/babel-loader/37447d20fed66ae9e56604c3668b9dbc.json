{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createLauncher = exports.resolveExecutablePath = exports.executablePathForChannel = void 0;\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst fs_1 = require(\"fs\");\nconst os_1 = __importDefault(require(\"os\"));\nconst BrowserFetcher_js_1 = require(\"./BrowserFetcher.js\");\nconst ChromeLauncher_js_1 = require(\"./ChromeLauncher.js\");\nconst FirefoxLauncher_js_1 = require(\"./FirefoxLauncher.js\");\n/**\n * @internal\n */\nfunction executablePathForChannel(channel) {\n  const platform = os_1.default.platform();\n  let chromePath;\n  switch (platform) {\n    case 'win32':\n      switch (channel) {\n        case 'chrome':\n          chromePath = `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n          break;\n        case 'chrome-beta':\n          chromePath = `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n          break;\n        case 'chrome-canary':\n          chromePath = `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n          break;\n        case 'chrome-dev':\n          chromePath = `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n          break;\n      }\n      break;\n    case 'darwin':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n          break;\n        case 'chrome-beta':\n          chromePath = '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n          break;\n        case 'chrome-canary':\n          chromePath = '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n          break;\n        case 'chrome-dev':\n          chromePath = '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n          break;\n      }\n      break;\n    case 'linux':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/opt/google/chrome/chrome';\n          break;\n        case 'chrome-beta':\n          chromePath = '/opt/google/chrome-beta/chrome';\n          break;\n        case 'chrome-dev':\n          chromePath = '/opt/google/chrome-unstable/chrome';\n          break;\n      }\n      break;\n  }\n  if (!chromePath) {\n    throw new Error(`Unable to detect browser executable path for '${channel}' on ${platform}.`);\n  }\n  // Check if Chrome exists and is accessible.\n  try {\n    (0, fs_1.accessSync)(chromePath);\n  } catch (error) {\n    throw new Error(`Could not find Google Chrome executable for channel '${channel}' at '${chromePath}'.`);\n  }\n  return chromePath;\n}\nexports.executablePathForChannel = executablePathForChannel;\n/**\n * @internal\n */\nfunction resolveExecutablePath(launcher) {\n  const {\n    product,\n    _isPuppeteerCore,\n    _preferredRevision\n  } = launcher;\n  let downloadPath;\n  // puppeteer-core doesn't take into account PUPPETEER_* env variables.\n  if (!_isPuppeteerCore) {\n    const executablePath = process.env['PUPPETEER_EXECUTABLE_PATH'] || process.env['npm_config_puppeteer_executable_path'] || process.env['npm_package_config_puppeteer_executable_path'];\n    if (executablePath) {\n      const missingText = !(0, fs_1.existsSync)(executablePath) ? 'Tried to use PUPPETEER_EXECUTABLE_PATH env variable to launch browser but did not find any executable at: ' + executablePath : undefined;\n      return {\n        executablePath,\n        missingText\n      };\n    }\n    const ubuntuChromiumPath = '/usr/bin/chromium-browser';\n    if (product === 'chrome' && os_1.default.platform() !== 'darwin' && os_1.default.arch() === 'arm64' && (0, fs_1.existsSync)(ubuntuChromiumPath)) {\n      return {\n        executablePath: ubuntuChromiumPath,\n        missingText: undefined\n      };\n    }\n    downloadPath = process.env['PUPPETEER_DOWNLOAD_PATH'] || process.env['npm_config_puppeteer_download_path'] || process.env['npm_package_config_puppeteer_download_path'];\n  }\n  const browserFetcher = new BrowserFetcher_js_1.BrowserFetcher({\n    product: product,\n    path: downloadPath\n  });\n  if (!_isPuppeteerCore) {\n    let revision = process.env['PUPPETEER_BROWSER_REVISION'];\n    if (product === 'chrome') {\n      revision !== null && revision !== void 0 ? revision : revision = process.env['PUPPETEER_CHROMIUM_REVISION'];\n    }\n    if (revision) {\n      const revisionInfo = browserFetcher.revisionInfo(revision);\n      const missingText = !revisionInfo.local ? 'Tried to use PUPPETEER_CHROMIUM_REVISION env variable to launch browser but did not find executable at: ' + revisionInfo.executablePath : undefined;\n      return {\n        executablePath: revisionInfo.executablePath,\n        missingText\n      };\n    }\n  }\n  const revisionInfo = browserFetcher.revisionInfo(_preferredRevision);\n  const firefoxHelp = `Run \\`PUPPETEER_PRODUCT=firefox npm install\\` to download a supported Firefox browser binary.`;\n  const chromeHelp = `Run \\`npm install\\` to download the correct Chromium revision (${launcher._preferredRevision}).`;\n  const missingText = !revisionInfo.local ? `Could not find expected browser (${product}) locally. ${product === 'chrome' ? chromeHelp : firefoxHelp}` : undefined;\n  return {\n    executablePath: revisionInfo.executablePath,\n    missingText\n  };\n}\nexports.resolveExecutablePath = resolveExecutablePath;\n/**\n * @internal\n */\nfunction createLauncher(preferredRevision, isPuppeteerCore) {\n  let product = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'chrome';\n  switch (product) {\n    case 'firefox':\n      return new FirefoxLauncher_js_1.FirefoxLauncher(preferredRevision, isPuppeteerCore);\n    case 'chrome':\n      return new ChromeLauncher_js_1.ChromeLauncher(preferredRevision, isPuppeteerCore);\n    default:\n      throw new Error(`Unknown product: ${product}`);\n  }\n}\nexports.createLauncher = createLauncher;","map":{"version":3,"mappings":"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","names":["executablePathForChannel","channel","platform","os_1","chromePath","process","env","Error","error","exports","resolveExecutablePath","launcher","product","_isPuppeteerCore","_preferredRevision","downloadPath","executablePath","missingText","undefined","ubuntuChromiumPath","arch","browserFetcher","BrowserFetcher_js_1","path","revision","revisionInfo","local","firefoxHelp","chromeHelp","createLauncher","preferredRevision","isPuppeteerCore","FirefoxLauncher_js_1","ChromeLauncher_js_1"],"sources":["../../../../src/node/ProductLauncher.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}