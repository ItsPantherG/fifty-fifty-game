{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2019 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _LifecycleWatcher_instances, _LifecycleWatcher_expectedLifecycle, _LifecycleWatcher_frameManager, _LifecycleWatcher_frame, _LifecycleWatcher_timeout, _LifecycleWatcher_navigationRequest, _LifecycleWatcher_eventListeners, _LifecycleWatcher_initialLoaderId, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, _LifecycleWatcher_sameDocumentNavigationPromise, _LifecycleWatcher_lifecycleCallback, _LifecycleWatcher_lifecyclePromise, _LifecycleWatcher_newDocumentNavigationCompleteCallback, _LifecycleWatcher_newDocumentNavigationPromise, _LifecycleWatcher_terminationCallback, _LifecycleWatcher_terminationPromise, _LifecycleWatcher_timeoutPromise, _LifecycleWatcher_maximumTimer, _LifecycleWatcher_hasSameDocumentNavigation, _LifecycleWatcher_swapped, _LifecycleWatcher_navigationResponseReceived, _LifecycleWatcher_onRequest, _LifecycleWatcher_onResponse, _LifecycleWatcher_onFrameDetached, _LifecycleWatcher_terminate, _LifecycleWatcher_createTimeoutPromise, _LifecycleWatcher_navigatedWithinDocument, _LifecycleWatcher_navigated, _LifecycleWatcher_frameSwapped, _LifecycleWatcher_checkLifecycleComplete;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LifecycleWatcher = void 0;\nconst assert_js_1 = require(\"../util/assert.js\");\nconst util_js_1 = require(\"./util.js\");\nconst DeferredPromise_js_1 = require(\"../util/DeferredPromise.js\");\nconst Errors_js_1 = require(\"./Errors.js\");\nconst FrameManager_js_1 = require(\"./FrameManager.js\");\nconst NetworkManager_js_1 = require(\"./NetworkManager.js\");\nconst Connection_js_1 = require(\"./Connection.js\");\nconst puppeteerToProtocolLifecycle = new Map([['load', 'load'], ['domcontentloaded', 'DOMContentLoaded'], ['networkidle0', 'networkIdle'], ['networkidle2', 'networkAlmostIdle']]);\nconst noop = () => {};\n/**\n * @internal\n */\nclass LifecycleWatcher {\n  constructor(frameManager, frame, waitUntil, timeout) {\n    _LifecycleWatcher_instances.add(this);\n    _LifecycleWatcher_expectedLifecycle.set(this, void 0);\n    _LifecycleWatcher_frameManager.set(this, void 0);\n    _LifecycleWatcher_frame.set(this, void 0);\n    _LifecycleWatcher_timeout.set(this, void 0);\n    _LifecycleWatcher_navigationRequest.set(this, null);\n    _LifecycleWatcher_eventListeners.set(this, void 0);\n    _LifecycleWatcher_initialLoaderId.set(this, void 0);\n    _LifecycleWatcher_sameDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_sameDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_lifecycleCallback.set(this, noop);\n    _LifecycleWatcher_lifecyclePromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_lifecycleCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_newDocumentNavigationCompleteCallback.set(this, noop);\n    _LifecycleWatcher_newDocumentNavigationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_terminationCallback.set(this, noop);\n    _LifecycleWatcher_terminationPromise.set(this, new Promise(fulfill => {\n      __classPrivateFieldSet(this, _LifecycleWatcher_terminationCallback, fulfill, \"f\");\n    }));\n    _LifecycleWatcher_timeoutPromise.set(this, void 0);\n    _LifecycleWatcher_maximumTimer.set(this, void 0);\n    _LifecycleWatcher_hasSameDocumentNavigation.set(this, void 0);\n    _LifecycleWatcher_swapped.set(this, void 0);\n    _LifecycleWatcher_navigationResponseReceived.set(this, void 0);\n    if (Array.isArray(waitUntil)) {\n      waitUntil = waitUntil.slice();\n    } else if (typeof waitUntil === 'string') {\n      waitUntil = [waitUntil];\n    }\n    __classPrivateFieldSet(this, _LifecycleWatcher_initialLoaderId, frame._loaderId, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_expectedLifecycle, waitUntil.map(value => {\n      const protocolEvent = puppeteerToProtocolLifecycle.get(value);\n      (0, assert_js_1.assert)(protocolEvent, 'Unknown value for options.waitUntil: ' + value);\n      return protocolEvent;\n    }), \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frameManager, frameManager, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frame, frame, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeout, timeout, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_eventListeners, [(0, util_js_1.addEventListener)(frameManager.client, Connection_js_1.CDPSessionEmittedEvents.Disconnected, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_terminate).bind(this, new Error('Navigation failed because browser has disconnected!'))), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.LifecycleEvent, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigatedWithinDocument, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigatedWithinDocument).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigated, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigated).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameSwapped, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_frameSwapped).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameDetached, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onFrameDetached).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManager_js_1.NetworkManagerEmittedEvents.Request, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequest).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManager_js_1.NetworkManagerEmittedEvents.Response, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onResponse).bind(this))], \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeoutPromise, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_createTimeoutPromise).call(this), \"f\");\n    __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n  }\n  async navigationResponse() {\n    var _a;\n    // Continue with a possibly null response.\n    await ((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.catch(() => {}));\n    return __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\") ? __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\").response() : null;\n  }\n  sameDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationPromise, \"f\");\n  }\n  newDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationPromise, \"f\");\n  }\n  lifecyclePromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_lifecyclePromise, \"f\");\n  }\n  timeoutOrTerminationPromise() {\n    return Promise.race([__classPrivateFieldGet(this, _LifecycleWatcher_timeoutPromise, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\")]);\n  }\n  dispose() {\n    (0, util_js_1.removeEventListeners)(__classPrivateFieldGet(this, _LifecycleWatcher_eventListeners, \"f\"));\n    __classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\") !== undefined && clearTimeout(__classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\"));\n  }\n}\nexports.LifecycleWatcher = LifecycleWatcher;\n_LifecycleWatcher_expectedLifecycle = new WeakMap(), _LifecycleWatcher_frameManager = new WeakMap(), _LifecycleWatcher_frame = new WeakMap(), _LifecycleWatcher_timeout = new WeakMap(), _LifecycleWatcher_navigationRequest = new WeakMap(), _LifecycleWatcher_eventListeners = new WeakMap(), _LifecycleWatcher_initialLoaderId = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_lifecycleCallback = new WeakMap(), _LifecycleWatcher_lifecyclePromise = new WeakMap(), _LifecycleWatcher_newDocumentNavigationCompleteCallback = new WeakMap(), _LifecycleWatcher_newDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_terminationCallback = new WeakMap(), _LifecycleWatcher_terminationPromise = new WeakMap(), _LifecycleWatcher_timeoutPromise = new WeakMap(), _LifecycleWatcher_maximumTimer = new WeakMap(), _LifecycleWatcher_hasSameDocumentNavigation = new WeakMap(), _LifecycleWatcher_swapped = new WeakMap(), _LifecycleWatcher_navigationResponseReceived = new WeakMap(), _LifecycleWatcher_instances = new WeakSet(), _LifecycleWatcher_onRequest = function _LifecycleWatcher_onRequest(request) {\n  var _a, _b;\n  if (request.frame() !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") || !request.isNavigationRequest()) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationRequest, request, \"f\");\n  // Resolve previous navigation response in case there are multiple\n  // navigation requests reported by the backend. This generally should not\n  // happen by it looks like it's possible.\n  (_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.resolve();\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationResponseReceived, (0, DeferredPromise_js_1.createDeferredPromise)(), \"f\");\n  if (request.response() !== null) {\n    (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n  }\n}, _LifecycleWatcher_onResponse = function _LifecycleWatcher_onResponse(response) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== response.request()._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onFrameDetached = function _LifecycleWatcher_onFrameDetached(frame) {\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") === frame) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, new Error('Navigating frame was detached'));\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_terminate = function _LifecycleWatcher_terminate(error) {\n  __classPrivateFieldGet(this, _LifecycleWatcher_terminationCallback, \"f\").call(null, error);\n}, _LifecycleWatcher_createTimeoutPromise = async function _LifecycleWatcher_createTimeoutPromise() {\n  if (!__classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")) {\n    return new Promise(noop);\n  }\n  const errorMessage = 'Navigation timeout of ' + __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\") + ' ms exceeded';\n  await new Promise(fulfill => {\n    return __classPrivateFieldSet(this, _LifecycleWatcher_maximumTimer, setTimeout(fulfill, __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")), \"f\");\n  });\n  return new Errors_js_1.TimeoutError(errorMessage);\n}, _LifecycleWatcher_navigatedWithinDocument = function _LifecycleWatcher_navigatedWithinDocument(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_hasSameDocumentNavigation, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_navigated = function _LifecycleWatcher_navigated(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_frameSwapped = function _LifecycleWatcher_frameSwapped(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_swapped, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_checkLifecycleComplete = function _LifecycleWatcher_checkLifecycleComplete() {\n  // We expect navigation to commit.\n  if (!checkLifecycle(__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_expectedLifecycle, \"f\"))) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_lifecycleCallback, \"f\").call(this);\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_hasSameDocumentNavigation, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_swapped, \"f\") || __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")._loaderId !== __classPrivateFieldGet(this, _LifecycleWatcher_initialLoaderId, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationCompleteCallback, \"f\").call(this);\n  }\n  function checkLifecycle(frame, expectedLifecycle) {\n    for (const event of expectedLifecycle) {\n      if (!frame._lifecycleEvents.has(event)) {\n        return false;\n      }\n    }\n    for (const child of frame.childFrames()) {\n      if (child._hasStartedLoading && !checkLifecycle(child, expectedLifecycle)) {\n        return false;\n      }\n    }\n    return true;\n  }\n};","map":{"version":3,"mappings":"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","names":["puppeteerToProtocolLifecycle","Map","noop","LifecycleWatcher","constructor","frameManager","frame","waitUntil","timeout","_LifecycleWatcher_expectedLifecycle","_LifecycleWatcher_frameManager","_LifecycleWatcher_frame","_LifecycleWatcher_timeout","_LifecycleWatcher_navigationRequest","_LifecycleWatcher_eventListeners","_LifecycleWatcher_initialLoaderId","_LifecycleWatcher_sameDocumentNavigationCompleteCallback","_LifecycleWatcher_sameDocumentNavigationPromise","Promise","fulfill","__classPrivateFieldSet","_LifecycleWatcher_lifecycleCallback","_LifecycleWatcher_lifecyclePromise","_LifecycleWatcher_newDocumentNavigationCompleteCallback","_LifecycleWatcher_newDocumentNavigationPromise","_LifecycleWatcher_terminationCallback","_LifecycleWatcher_terminationPromise","_LifecycleWatcher_timeoutPromise","_LifecycleWatcher_maximumTimer","_LifecycleWatcher_hasSameDocumentNavigation","_LifecycleWatcher_swapped","_LifecycleWatcher_navigationResponseReceived","Array","isArray","slice","_loaderId","map","value","protocolEvent","get","client","Connection_js_1","Disconnected","__classPrivateFieldGet","bind","Error","FrameManager_js_1","LifecycleEvent","FrameNavigatedWithinDocument","FrameNavigated","FrameSwapped","FrameDetached","networkManager","NetworkManager_js_1","Request","Response","navigationResponse","catch","response","sameDocumentNavigationPromise","newDocumentNavigationPromise","lifecyclePromise","timeoutOrTerminationPromise","race","dispose","undefined","clearTimeout","exports","request","isNavigationRequest","resolve","_requestId","call","error","_LifecycleWatcher_createTimeoutPromise","errorMessage","setTimeout","Errors_js_1","checkLifecycle","expectedLifecycle","event","_lifecycleEvents","has","child","childFrames","_hasStartedLoading"],"sources":["../../../../src/common/LifecycleWatcher.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}